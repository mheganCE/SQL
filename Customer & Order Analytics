/* In this SQL, I'm querying data from a multiple tables to assess customer data and product orders.

-- displays JanSales filtered out the blank and incorrect order ID
SELECT * 
FROM JanSales 
WHERE orderID <> "Order ID"

--- 1. How many orders were placed in January?
SELECT COUNT(orderID) 
FROM JanSales 
WHERE orderID <> "Order ID" 
AND length(orderID) = 6

--- 2. How many of those orders were for an iPhone? 
SELECT COUNT(orderID)
FROM JanSales 
WHERE Product ="iPhone" 
AND orderID <> "Order ID"

--- 3. Select the customer account numbers for all the orders that were placed in February. 
SELECT acctnum 
FROM customers
LEFT JOIN FebSales
ON order_id=orderID
WHERE orderID <> "Order ID" AND length(orderID) = 6

--- 4. Which product was the cheapest one sold in January, and what was the price? 
SELECT Product, MIN(Price) 
FROM JanSales
GROUP BY product, price
ORDER BY price ASC

--- 5. What is the total revenue for each product sold in January? (Revenue can be calculated using the number of products sold and 
       the price of the products).
SELECT  product, SUM(Quantity*price) as revenue 
FROM JanSales 
WHERE orderID <> "Order ID" 
GROUP BY Product

--- 6. Which products were sold in February at 548 Lincoln St, Seattle, WA 98101, how many of each were sold, and what was the total revenue?
SELECT Product, Sum(Quantity) as total_sold, SUM(Quantity*Price) as revenue 
FROM FebSales 
WHERE location="548 Lincoln St, Seattle, WA 98101" 
GROUP BY Product

--- 7. How many customers ordered more than 2 products at a time in February, and what was the average amount spent for those customers? 
SELECT COUNT(cust.acctnum), AVG(quantity*price) as avg 
FROM FebSales
LEFT JOIN customers cust
ON order_id=orderID
WHERE quantity > 2 AND orderID <> "Order id" AND length(orderID) = 6
